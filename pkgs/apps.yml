packages:
- name: busybox
  architecture: "@OPTION:arch@"
  labels: [ broken ] # Needs patch
  source:
    subdir: ports
    git: "https://git.busybox.net/busybox"
    tag: "1_37_0"
    version: "1.37.0"
  revision: 1
  tools_required:
  - host-gcc
  - host-binutils
  configure:
  - args: [ "cp", "@SOURCE_ROOT@/support/busybox/.config", "@THIS_BUILD_DIR@/.config.in" ]
  - args: |
      envsubst < "@THIS_BUILD_DIR@/.config.in" > "@THIS_BUILD_DIR@/.config"
    environ:
      OS_TRIPLET: "@OPTION:arch@-@OPTION:triple@"
      SYSROOT_DIR: "@SYSROOT_DIR@"
      PREFIX_DIR: "@THIS_COLLECT_DIR@/usr"
  - args: [ "make", "KBUILD_SRC=@THIS_SOURCE_DIR@", "-f", "@THIS_SOURCE_DIR@/Makefile", "oldconfig" ]
  build:
  - args: [ "make", "-j@PARALLELISM@" ]
  - args: [ "make", "-j@PARALLELISM@", "install" ]

- name: fastfetch
  architecture: "@OPTION:arch@"
  labels: [ broken ] # Needs patch
  source:
    subdir: ports
    url: "https://github.com/fastfetch-cli/fastfetch/archive/refs/tags/2.33.0.tar.gz"
    format: "tar.gz"
    checksum: "blake2b:1a31aa0b7651c27ecff34067360c136ad5c0dddac60e5bc2c4ae749194d63c49df3bc92de91e5a3249b8bcd1f640b62025a01d7f6b89b96991ad1623ca079bb5"
    version: "2.33.0"
    patch-path-strip: 1
  tools_required:
  - host-cmake
  - host-gcc
  pkgs_required:
  - mlibc
  revision: 1
  configure:
  - args:
    - "cmake"
    - "-DCMAKE_TOOLCHAIN_FILE=@SOURCE_ROOT@/support/CMakeToolchain-@OPTION:arch@.txt"
    - "-DCMAKE_BUILD_TYPE=Release"
    - "-DCMAKE_INSTALL_PREFIX=/usr"
    - "-DENABLE_RPM=no"
    - "-DENABLE_ZLIB=no"
    - "-DENABLE_SYSTEM_YYJSON=no"
    - "-DINSTALL_LICENSE=no"
    - "-DBUILD_FLASHFETCH=no"
    - "-DENABLE_CHAFA=no"
    - "-DENABLE_DBUS=no"
    - "-DENABLE_DCONF=no"
    - "-DENABLE_DDCUTIL=no"
    - "-DENABLE_DRM=no"
    - "-DENABLE_ELF=no"
    - "-DENABLE_EGL=no"
    - "-DENABLE_GIO=no"
    - "-DENABLE_GLX=no"
    - "-DENABLE_IMAGEMAGICK6=no"
    - "-DENABLE_IMAGEMAGICK7=no"
    - "-DENABLE_OPENCL=no"
    - "-DENABLE_OSMESA=no"
    - "-DENABLE_PULSE=no"
    - "-DENABLE_SQLITE3=no"
    - "-DENABLE_VULKAN=no"
    - "-DENABLE_WAYLAND=no"
    - "-DENABLE_XCB_RANDR=no"
    - "-DENABLE_XFCONF=no"
    - "-DENABLE_XRANDR=no"
    - "-DBUILD_TESTS=no"
    - "-DPACKAGES_DISABLE_XBPS=OFF"
    - "@THIS_SOURCE_DIR@"
  build:
  - args: [ "make", "-j@PARALLELISM@" ]
  - args: [ "make", "install" ]
    environ:
      DESTDIR: "@THIS_COLLECT_DIR@"
