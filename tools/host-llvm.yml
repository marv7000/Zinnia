tools:
- name: host-llvm
  architecture: "@OPTION:arch@"
  exports_shared_libs: true
  from_source: llvm
  sources_required:
  - binutils
  tools_required:
  - host-cmake
  - host-gcc
  revision: 1
  configure:
  - args:
    - "cmake"
    - "-GNinja"
    - "-DCMAKE_INSTALL_PREFIX=@PREFIX@"
    - "-DCMAKE_C_COMPILER=gcc"
    - "-DCMAKE_CXX_COMPILER=g++"
    - "-DCMAKE_BUILD_TYPE=Release"
    - "-DDEFAULT_SYSROOT=@SYSROOT_DIR@"
    - "-UBUILD_SHARED_LIBS"
    - "-UENABLE_STATIC"
    - "-DLLVM_LINK_LLVM_DYLIB=ON"
    - "-DLLVM_TARGETS_TO_BUILD=X86;AArch64;RISCV;LoongArch"
    - "-DLLVM_ENABLE_FFI=ON"
    - "-DLLVM_ENABLE_EH=ON"
    - "-DLLVM_ENABLE_RTTI=ON"
    - "-DLLVM_ENABLE_PROJECTS=clang;lld"
    - "-DLLVM_BINUTILS_INCDIR=@SOURCE_ROOT@/ports/binutils/include"
    - "-DLLVM_DEFAULT_TARGET_TRIPLE=@OPTION:arch@-@OPTION:triple@"
    - "@THIS_SOURCE_DIR@/llvm"
  compile:
  - args: [ "ninja" ]
  install:
  - args: [ "ninja", "install" ]
